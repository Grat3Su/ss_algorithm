package hw;
///https://www.acmicpc.net/problem/15961

import java.util.*;
import java.io.*;

/* n(접시수) d(가짓수d) k(연속으로 먹는 접시 수) c(쿠폰번호)
 * 8 30 4 30
7
9
7
30
2
7
9
25
 */
//슬라이딩 윈도우


public class BOJ_15961_Sushi2 {
	static int N,D,K,C,ans;
	static int[] rail;
	static int[] sushi,arr;//이 배열에 투포인터로  ++ --
	public static void main(String[] args) throws Exception{
		BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
		StringTokenizer st = new StringTokenizer(br.readLine());
		Queue<Integer>queue = new ArrayDeque<Integer>();
		
		N = Integer.parseInt(st.nextToken());
		D = Integer.parseInt(st.nextToken());
		K = Integer.parseInt(st.nextToken());
		C = Integer.parseInt(st.nextToken());
		ans = 0;
		sushi = new int[D+1];
		rail = new int[N];
		for(int i = 0; i<N; i++) {
			rail[i] = Integer.parseInt(br.readLine());
		}

		slide();
		System.out.println(ans);
	}
	
	static void slide() {
		int total=0;
		for (int i = 0; i < K; i++) {
			if(sushi[rail[i]] ==0) total++;
			sushi[rail[i]]++;//레일에 있는 초밥의 수를 올린다.
		}
		ans = total;
		
		for (int i = 1; i < N; i++) {
			if(ans<=total) {
				if(sushi[C]==0) {
					ans = total+1;
				}else {
					ans = total;
				}
			}
			//회전 초밥
			sushi[arr[i-1]]--;
			if(sushi[arr[i-1]]==0)total--;
			
			if(sushi[arr[(i+K-1)%N]]==0)total++;
			sushi[arr[(i+K-1)%N]]++;
		}
	}
	
	

}
